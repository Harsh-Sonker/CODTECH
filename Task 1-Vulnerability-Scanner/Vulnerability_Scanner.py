import nmap
import requests
from bs4 import BeautifulSoup

def scan_open_ports(target):
    nm = nmap.PortScanner()
    nm.scan(target, '1-1024')
    print(f"Scanning open ports on {target}")
    for host in nm.all_hosts():
        print(f"Host: {host}")
        for proto in nm[host].all_protocols():
            print(f"Protocol: {proto}")
            lport = nm[host][proto].keys()
            for port in lport:
                state = nm[host][proto][port]['state']
                print(f"Port: {port}, State: {state}")

def get_latest_apache_version():
    url = "https://httpd.apache.org/download.cgi"
    response = requests.get(url)
    if response.status_code == 200:
        soup = BeautifulSoup(response.text, 'html.parser')
        # Look for the latest version information
        latest_version = "2.4.61"  # Manually set the latest version (as per your update)
        return latest_version
    else:
        print(f"Could not check the latest version of Apache (HTTP error {response.status_code})")
        return None

def check_software_version(url, software_name, current_version):
    latest_version = get_latest_apache_version()
    if latest_version:
        if current_version != latest_version:
            print(f"Update available for {software_name}. Current version: {current_version}, Latest version: {latest_version}")
        else:
            print(f"{software_name} is up-to-date.")
    else:
        print(f"Could not check the latest version of {software_name}")

def check_common_misconfigurations():
    print("Checking for common misconfigurations...")
    # Add specific checks here as needed
    print("No common misconfigurations found (dummy check).")

if __name__ == "__main__":
    target = input("Enter the target IP address or hostname: ")
    
    # Scan open ports
    scan_open_ports(target)

    # Check for outdated software versions (example for Apache)
    current_version = "2.4.61"  # Replace with actual current version
    check_software_version("", "Apache", current_version)

    # Check for common misconfigurations
    check_common_misconfigurations()
